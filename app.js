// –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏
const appData = {
  vasilchenko_male_full: {
    vectors: [
      {
        name: "libido_awakening", 
        label: "–í–æ–∑—Ä–∞—Å—Ç –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è –ª–∏–±–∏–¥–æ (–ª–µ—Ç)", 
        type: "number",
        explanation: "–í –∫–∞–∫–æ–º –≤–æ–∑—Ä–∞—Å—Ç–µ —É –≤–∞—Å –≤–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–∏–ª–æ—Å—å –ø–æ–ª–æ–≤–æ–µ –≤–ª–µ—á–µ–Ω–∏–µ –∫ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–º—É –ø–æ–ª—É? –≠—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω–æ —Å —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é - —Ä–µ—á—å –æ –ø–µ—Ä–≤–æ–º –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–µ—Å–µ, —ç—Ä–æ—Ç–∏—á–µ—Å–∫–∏—Ö –º—ã—Å–ª—è—Ö –∏–ª–∏ —Ñ–∞–Ω—Ç–∞–∑–∏—è—Ö.",
        scoring: {"18+": 1, "17": 2, "16": 3, "15": 4, "14": 5, "13": 6, "12": 7, "11": 8, "10-": 9}
      },
      {
        name: "first_ejaculation", 
        label: "–í–æ–∑—Ä–∞—Å—Ç –ø–µ—Ä–≤–æ–π —ç—è–∫—É–ª—è—Ü–∏–∏ (–ª–µ—Ç)", 
        type: "number",
        explanation: "–í –∫–∞–∫–æ–º –≤–æ–∑—Ä–∞—Å—Ç–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –ø–µ—Ä–≤–∞—è —ç—è–∫—É–ª—è—Ü–∏—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø—Ä–∏—á–∏–Ω—ã - –ø–æ–ª–æ–≤–æ–π –∞–∫—Ç, –º–∞—Å—Ç—É—Ä–±–∞—Ü–∏—è –∏–ª–∏ –ø–æ–ª–ª—é—Ü–∏—è (–Ω–µ–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Å–µ–º—è–∏–∑–≤–µ—Ä–∂–µ–Ω–∏–µ –≤–æ —Å–Ω–µ)?",
        scoring: {"19+": 1, "18": 2, "17": 3, "16": 4, "15": 5, "14": 6, "13": 7, "12": 8, "11-": 9}
      },
      {
        name: "trochanter_index", 
        label: "–¢—Ä–æ—Ö–∞–Ω—Ç–µ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å", 
        type: "number",
        explanation: "–û—Ç–Ω–æ—à–µ–Ω–∏–µ –æ–±—â–µ–≥–æ —Ä–æ—Å—Ç–∞ –∫ –¥–ª–∏–Ω–µ –Ω–æ–≥–∏ –æ—Ç –±–æ–ª—å—à–æ–≥–æ –≤–µ—Ä—Ç–µ–ª–∞ –±–µ–¥—Ä–∞ –¥–æ –ø–æ–ª–∞. –•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ —Ç–µ–ª–∞ –∏ —Å–≤—è–∑–∞–Ω —Å –≥–æ—Ä–º–æ–Ω–∞–ª—å–Ω—ã–º —Ñ–æ–Ω–æ–º. –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ.",
        scoring: {"2.03+": 1, "2.01-2.02": 2, "2.00": 3, "1.98-1.99": 4, "1.95-1.97": 5, "1.93-1.94": 6, "1.91-1.92": 7, "1.89-1.90": 8, "1.88-": 9}
      },
      {
        name: "pubic_hair", 
        label: "–•–∞—Ä–∞–∫—Ç–µ—Ä –æ–≤–æ–ª–æ—Å–µ–Ω–∏—è –ª–æ–±–∫–∞", 
        type: "radio",
        explanation: "–¢–∏–ø —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–æ–ª–æ—Å –≤ –æ–±–ª–∞—Å—Ç–∏ –ª–æ–±–∫–∞ –æ—Ç—Ä–∞–∂–∞–µ—Ç –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≥–æ—Ä–º–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–æ–Ω–∞. –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Å–º. –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ.",
        options: [
          {value: 1, label: "–ü–æ –∂–µ–Ω—Å–∫–æ–º—É —Ç–∏–ø—É", description: "–¢—Ä–µ—É–≥–æ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ —Å —á–µ—Ç–∫–æ–π –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–µ–π, –≤–æ–ª–æ—Å—ã –Ω–µ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –Ω–∞ –∂–∏–≤–æ—Ç"}, 
          {value: 4, label: "–ü–µ—Ä–µ—Ö–æ–¥–Ω—ã–π —Ç–∏–ø", description: "–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –º–µ–∂–¥—É –∂–µ–Ω—Å–∫–∏–º –∏ –º—É–∂—Å–∫–∏–º —Ç–∏–ø–æ–º"}, 
          {value: 7, label: "–ü–æ –º—É–∂—Å–∫–æ–º—É —Ç–∏–ø—É", description: "–†–æ–º–±–æ–≤–∏–¥–Ω–∞—è —Ñ–æ—Ä–º–∞ —Å –ø–µ—Ä–µ—Ö–æ–¥–æ–º –≤–æ–ª–æ—Å –ø–æ –±–µ–ª–æ–π –ª–∏–Ω–∏–∏ –Ω–∞ –∂–∏–≤–æ—Ç –¥–æ –ø—É–ø–∫–∞"}, 
          {value: 9, label: "–ì–∏–ø–µ—Ä—Ç—Ä–∏—Ö–æ–∑", description: "–ò–∑–±—ã—Ç–æ—á–Ω–æ–µ –æ–≤–æ–ª–æ—Å–µ–Ω–∏–µ —Å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ–º –Ω–∞ –±–µ–¥—Ä–∞ –∏ –∂–∏–≤–æ—Ç"}
        ]
      },
      {
        name: "max_excess", 
        label: "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç—è–∫—É–ª—è—Ü–∏–π –∑–∞ 24 —á–∞—Å–∞", 
        type: "number",
        explanation: "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç—è–∫—É–ª—è—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Å–ø–æ—Å–æ–±–Ω—ã —Å–æ–≤–µ—Ä—à–∏—Ç—å –∑–∞ —Å—É—Ç–∫–∏ –≤ –ø–µ—Ä–∏–æ–¥ –Ω–∞–∏–≤—ã—Å—à–µ–π —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–æ–±—ã—á–Ω–æ –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ 20-30 –ª–µ—Ç).",
        scoring: {"1": 1, "2": 2, "3": 3, "4": 4, "5": 5, "6": 6, "7": 7, "8-9": 8, "10+": 9}
      },
      {
        name: "ufr_time",
        label: "–í—Ä–µ–º—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –£–§–† –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ –ø–æ–ª–æ–≤–æ–π –∂–∏–∑–Ω–∏ (–ª–µ—Ç)",
        type: "radio",
        explanation: "–£–§–† (—É—Å–ª–æ–≤–Ω—ã–π —Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ä–∏—Ç–º) - —ç—Ç–æ —É—Å—Ç–æ–π—á–∏–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞ –ø–æ–ª–æ–≤—ã—Ö –∞–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä–∞—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–∏–æ–¥–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏. –≠—Ç–æ —Ç–æ—Ç —Ä–∏—Ç–º —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–ª—è –≤–∞—Å –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–º –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º. –ß–µ—Ä–µ–∑ —Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –ø–æ–ª–æ–≤–æ–π –∂–∏–∑–Ω–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è —Ç–∞–∫–æ–π –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Ä–∏—Ç–º? (–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç –Ω–∞—á–∞–ª–∞ —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)",
        options: [
          {value: 1, label: "–ù–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è", description: "–†–∏—Ç–º —Ç–∞–∫ –∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è"},
          {value: 2, label: "–ë–æ–ª–µ–µ 10 –ª–µ—Ç", description: ""},
          {value: 3, label: "6-10 –ª–µ—Ç", description: ""},
          {value: 4, label: "3-5 –ª–µ—Ç", description: ""},
          {value: 5, label: "2 –≥–æ–¥–∞", description: ""},
          {value: 6, label: "1 –≥–æ–¥", description: ""},
          {value: 7, label: "–î–æ 1 –≥–æ–¥–∞", description: ""}
        ]
      },
      {
        name: "ufr_age",
        label: "–ê–±—Å–æ–ª—é—Ç–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –£–§–† (–ª–µ—Ç)",
        type: "radio",
        explanation: "–í –∫–∞–∫–æ–º –≤–æ–∑—Ä–∞—Å—Ç–µ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π, —É—Å—Ç—Ä–∞–∏–≤–∞—é—â–∏–π –≤–∞—Å —Ä–∏—Ç–º –ø–æ–ª–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏? (–ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç, –∫–æ–≥–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è —Ä–∏—Ç–º, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏)",
        options: [
          {value: 1, label: "–ù–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è", description: "–†–∏—Ç–º —Ç–∞–∫ –∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è"},
          {value: 2, label: "–ë–æ–ª–µ–µ 40 –ª–µ—Ç", description: ""},
          {value: 3, label: "36-40 –ª–µ—Ç", description: ""},
          {value: 4, label: "31-35 –ª–µ—Ç", description: ""},
          {value: 5, label: "26-30 –ª–µ—Ç", description: ""},
          {value: 6, label: "21-25 –ª–µ—Ç", description: ""},
          {value: 7, label: "–î–æ 20 –ª–µ—Ç", description: ""}
        ]
      }
    ]
  },
  vasilchenko_female_full: {
    vectors: [
      {
        name: "menarche", 
        label: "–í–æ–∑—Ä–∞—Å—Ç –ø–µ—Ä–≤–æ–π –º–µ–Ω—Å—Ç—Ä—É–∞—Ü–∏–∏ (–ª–µ—Ç)", 
        type: "number",
        explanation: "–í –∫–∞–∫–æ–º –≤–æ–∑—Ä–∞—Å—Ç–µ —É –≤–∞—Å –Ω–∞—á–∞–ª–∞—Å—å –ø–µ—Ä–≤–∞—è –º–µ–Ω—Å—Ç—Ä—É–∞—Ü–∏—è (–º–µ–Ω–∞—Ä—Ö–µ)? –≠—Ç–æ –≤–∞–∂–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –ø–æ–ª–æ–≤–æ–≥–æ —Å–æ–∑—Ä–µ–≤–∞–Ω–∏—è.",
        scoring: {"17+": 1, "16": 2, "15": 3, "14": 4, "13": 5, "12": 6, "11": 7, "10": 8, "9-": 9}
      },
      {
        name: "menstruation_regularity", 
        label: "–†–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å –º–µ–Ω—Å—Ç—Ä—É–∞—Ü–∏–π", 
        type: "radio",
        explanation: "–ö–∞–∫ –±—ã—Å—Ç—Ä–æ –ø–æ—Å–ª–µ –º–µ–Ω–∞—Ä—Ö–µ —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π —Ü–∏–∫–ª –∏ –∫–∞–∫–æ–≤ –µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä? –û—Ü–µ–Ω–∏—Ç–µ –æ–±—â–µ–µ —Ç–µ—á–µ–Ω–∏–µ –º–µ–Ω—Å—Ç—Ä—É–∞—Ü–∏–π –≤ –ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤–æ–º –≤–æ–∑—Ä–∞—Å—Ç–µ.",
        options: [
          {value: 1, label: "–ù–µ—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ, –±–æ–ª–µ–∑–Ω–µ–Ω–Ω—ã–µ", description: "–î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ü–∏–∫–ª–∞ —Å —Å–∏–ª—å–Ω—ã–º–∏ –±–æ–ª—è–º–∏"}, 
          {value: 2, label: "–ù–µ—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ", description: "–ß–∞—Å—Ç—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ü–∏–∫–ª–∞ –±–µ–∑ —Å–∏–ª—å–Ω—ã—Ö –±–æ–ª–µ–π"}, 
          {value: 3, label: "–†–µ–¥–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è", description: "–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ —Å–±–æ–∏ —Ü–∏–∫–ª–∞"}, 
          {value: 5, label: "–†–µ–≥—É–ª—è—Ä–Ω—ã–µ", description: "–¶–∏–∫–ª —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ –≥–æ–¥–∞"}, 
          {value: 7, label: "–†–µ–≥—É–ª—è—Ä–Ω—ã–µ —Å —Ä–∞–Ω–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞", description: "–¶–∏–∫–ª —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è —Å—Ä–∞–∑—É –∏ –ø—Ä–æ—Ç–µ–∫–∞–ª –±–µ–∑ –ø—Ä–æ–±–ª–µ–º"}
        ]
      },
      {
        name: "pregnancy_onset", 
        label: "–ù–∞—Å—Ç—É–ø–ª–µ–Ω–∏–µ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏", 
        type: "radio",
        explanation: "–ö–∞–∫ –±—ã—Å—Ç—Ä–æ –Ω–∞—Å—Ç—É–ø–∏–ª–∞ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–∞—Ö –∑–∞—á–∞—Ç–∏—è? –ï—Å–ª–∏ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–µ–π –Ω–µ –±—ã–ª–æ, –≤—ã–±–µ—Ä–∏—Ç–µ '–ù–µ –±—ã–ª–æ –ø–æ–ø—ã—Ç–æ–∫' –∏–ª–∏ –æ—Ü–µ–Ω–∏—Ç–µ –ø–æ —Å–≤–æ–∏–º –æ—â—É—â–µ–Ω–∏—è–º.",
        options: [
          {value: 0, label: "–ù–µ –±—ã–ª–æ –ø–æ–ø—ã—Ç–æ–∫", description: "–ù–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–∏ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å"}, 
          {value: 1, label: "–ù–µ –Ω–∞—Å—Ç—É–ø–∞–µ—Ç –±–æ–ª–µ–µ 2 –ª–µ—Ç", description: "–ü—Ä–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö"}, 
          {value: 2, label: "–ß–µ—Ä–µ–∑ 2-3 –≥–æ–¥–∞", description: ""}, 
          {value: 3, label: "–ß–µ—Ä–µ–∑ 1-2 –≥–æ–¥–∞", description: ""}, 
          {value: 4, label: "–ß–µ—Ä–µ–∑ 6-12 –º–µ—Å—è—Ü–µ–≤", description: ""}, 
          {value: 5, label: "–ß–µ—Ä–µ–∑ 3-6 –º–µ—Å—è—Ü–µ–≤", description: ""}, 
          {value: 6, label: "–ß–µ—Ä–µ–∑ 1-3 –º–µ—Å—è—Ü–∞", description: ""}, 
          {value: 7, label: "–í –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü –ø–æ–ø—ã—Ç–æ–∫", description: ""}, 
          {value: 8, label: "–°—Ä–∞–∑—É/–Ω–µ–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ", description: ""}
        ]
      },
      {
        name: "pregnancy_course", 
        label: "–¢–µ—á–µ–Ω–∏–µ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏", 
        type: "radio",
        explanation: "–ö–∞–∫ –ø—Ä–æ—Ç–µ–∫–∞–ª–∏ –≤–∞—à–∏ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏? –ï—Å–ª–∏ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–µ–π –Ω–µ –±—ã–ª–æ, –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å, –≤—ã–±—Ä–∞–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç.",
        options: [
          {value: 0, label: "–ù–µ –±—ã–ª–æ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–µ–π", description: ""}, 
          {value: 2, label: "–° —Å–µ—Ä—å–µ–∑–Ω—ã–º–∏ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏—è–º–∏", description: "–ì–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏, —É–≥—Ä–æ–∑—ã, —Å–µ—Ä—å–µ–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã"}, 
          {value: 3, label: "–° –ª–µ–≥–∫–∏–º–∏ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏—è–º–∏", description: "–¢–æ–∫—Å–∏–∫–æ–∑, –Ω–µ–±–æ–ª—å—à–∏–µ –ø—Ä–æ–±–ª–µ–º—ã"}, 
          {value: 4, label: "–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ç–µ—á–µ–Ω–∏–µ", description: "–ë–µ–∑ —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º"}, 
          {value: 6, label: "–õ–µ–≥–∫–æ–µ –ø—Ä–æ—Ç–µ–∫–∞–Ω–∏–µ", description: "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç"}, 
          {value: 7, label: "–û—á–µ–Ω—å –ª–µ–≥–∫–æ–µ", description: "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ –Ω–µ—É–¥–æ–±—Å—Ç–≤"}, 
          {value: 8, label: "–ò–¥–µ–∞–ª—å–Ω–æ–µ", description: "–û—Ç–ª–∏—á–Ω–æ–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–π –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏"}
        ]
      },
      {
        name: "trochanter_index", 
        label: "–¢—Ä–æ—Ö–∞–Ω—Ç–µ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å", 
        type: "number",
        explanation: "–û—Ç–Ω–æ—à–µ–Ω–∏–µ –æ–±—â–µ–≥–æ —Ä–æ—Å—Ç–∞ –∫ –¥–ª–∏–Ω–µ –Ω–æ–≥–∏ –æ—Ç –±–æ–ª—å—à–æ–≥–æ –≤–µ—Ä—Ç–µ–ª–∞ –±–µ–¥—Ä–∞ –¥–æ –ø–æ–ª–∞. –£ –∂–µ–Ω—â–∏–Ω —ç—Ç–æ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –æ–±—ã—á–Ω–æ –≤—ã—à–µ, —á–µ–º —É –º—É–∂—á–∏–Ω.",
        scoring: {"1.88-1.92": 1, "1.93-1.94": 2, "1.95-1.96": 3, "1.97-1.98": 4, "1.99-2.00": 5, "2.01-2.02": 6, "2.03-2.04": 7, "2.05+": 8}
      },
      {
        name: "pubic_hair", 
        label: "–•–∞—Ä–∞–∫—Ç–µ—Ä –æ–≤–æ–ª–æ—Å–µ–Ω–∏—è –ª–æ–±–∫–∞", 
        type: "radio",
        explanation: "–¢–∏–ø –∏ –æ–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–æ–ª–æ—Å –≤ –æ–±–ª–∞—Å—Ç–∏ –ª–æ–±–∫–∞. –£ –∂–µ–Ω—â–∏–Ω –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –∏ —Ñ–æ—Ä–º–∞ –æ–≤–æ–ª–æ—Å–µ–Ω–∏—è.",
        options: [
          {value: 1, label: "–°–∫—É–¥–Ω–æ–µ, –ø–æ –º—É–∂—Å–∫–æ–º—É —Ç–∏–ø—É", description: "–ú–∞–ª–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ª–æ—Å, —Ä–æ–º–±–æ–≤–∏–¥–Ω–∞—è —Ñ–æ—Ä–º–∞"}, 
          {value: 3, label: "–£–º–µ—Ä–µ–Ω–Ω–æ–µ", description: "–°—Ä–µ–¥–Ω—è—è –≥—É—Å—Ç–æ—Ç–∞, –ø–µ—Ä–µ—Ö–æ–¥–Ω–∞—è —Ñ–æ—Ä–º–∞"}, 
          {value: 5, label: "–ü–æ –∂–µ–Ω—Å–∫–æ–º—É —Ç–∏–ø—É", description: "–¢—Ä–µ—É–≥–æ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞, –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è –≥—É—Å—Ç–æ—Ç–∞"}, 
          {value: 8, label: "–û—á–µ–Ω—å –æ–±–∏–ª—å–Ω–æ–µ", description: "–ì—É—Å—Ç–æ–µ –æ–≤–æ–ª–æ—Å–µ–Ω–∏–µ –ø–æ –∂–µ–Ω—Å–∫–æ–º—É —Ç–∏–ø—É"}
        ]
      },
      {
        name: "libido_awakening", 
        label: "–í–æ–∑—Ä–∞—Å—Ç –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è –ª–∏–±–∏–¥–æ (–ª–µ—Ç)", 
        type: "number",
        explanation: "–í –∫–∞–∫–æ–º –≤–æ–∑—Ä–∞—Å—Ç–µ –≤–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–∏–ª–æ—Å—å —ç—Ä–æ—Ç–∏—á–µ—Å–∫–æ–µ –≤–ª–µ—á–µ–Ω–∏–µ, –∏–Ω—Ç–µ—Ä–µ—Å –∫ —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º –∏–ª–∏ —Å–µ–∫—Å—É–∞–ª—å–Ω—ã–µ —Ñ–∞–Ω—Ç–∞–∑–∏–∏?",
        scoring: {"18+": 1, "17": 2, "16": 3, "15": 4, "14": 5, "13": 6, "12": 7, "11": 8, "10-": 9}
      },
      {
        name: "first_orgasm", 
        label: "–í–æ–∑—Ä–∞—Å—Ç –ø–µ—Ä–≤–æ–≥–æ –æ—Ä–≥–∞–∑–º–∞ (–ª–µ—Ç)", 
        type: "number",
        explanation: "–í –∫–∞–∫–æ–º –≤–æ–∑—Ä–∞—Å—Ç–µ –±—ã–ª –ø–µ—Ä–≤—ã–π –æ—Ä–≥–∞–∑–º –ª—é–±—ã–º —Å–ø–æ—Å–æ–±–æ–º - –≤ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–µ, –ø—Ä–∏ –º–∞—Å—Ç—É—Ä–±–∞—Ü–∏–∏ –∏–ª–∏ —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ?",
        scoring: {"35+": 1, "30-34": 2, "26-29": 3, "21-25": 4, "18-20": 5, "17-18": 6, "16-17": 7, "15-16": 8, "15-": 9}
      },
      {
        name: "orgasm_time", 
        label: "–í—Ä–µ–º—è –¥–æ –ø–µ—Ä–≤–æ–≥–æ –æ—Ä–≥–∞–∑–º–∞ –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ –ø–æ–ª–æ–≤–æ–π –∂–∏–∑–Ω–∏", 
        type: "radio",
        explanation: "–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ –æ—Ç –Ω–∞—á–∞–ª–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –ø–æ–ª–æ–≤–æ–π –∂–∏–∑–Ω–∏ –¥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –æ—Ä–≥–∞–∑–º–∞ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º?",
        options: [
          {value: 1, label: "–ë–æ–ª–µ–µ 3 –ª–µ—Ç", description: "–î–æ–ª–≥–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏"}, 
          {value: 2, label: "2-3 –≥–æ–¥–∞", description: ""}, 
          {value: 3, label: "1-2 –≥–æ–¥–∞", description: ""}, 
          {value: 4, label: "6-12 –º–µ—Å—è—Ü–µ–≤", description: ""}, 
          {value: 5, label: "3-6 –º–µ—Å—è—Ü–µ–≤", description: ""}, 
          {value: 6, label: "1-3 –º–µ—Å—è—Ü–∞", description: ""}, 
          {value: 7, label: "–î–æ 1 –º–µ—Å—è—Ü–∞", description: ""}, 
          {value: 8, label: "–° –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞", description: "–°—Ä–∞–∑—É –ø—Ä–∏ –Ω–∞—á–∞–ª–µ –ø–æ–ª–æ–≤–æ–π –∂–∏–∑–Ω–∏"}
        ]
      },
      {
        name: "orgasmic_achievement", 
        label: "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –æ—Ä–≥–∞–∑–º–∞ (% —Å–ª—É—á–∞–µ–≤)", 
        type: "radio",
        explanation: "–í –∫–∞–∫–æ–º –ø—Ä–æ—Ü–µ–Ω—Ç–µ —Å–ª—É—á–∞–µ–≤ –ø–æ–ª–æ–≤–æ–π –±–ª–∏–∑–æ—Å—Ç–∏ –≤—ã –¥–æ—Å—Ç–∏–≥–∞–µ—Ç–µ –æ—Ä–≥–∞–∑–º–∞ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –∏–ª–∏ –¥–æ—Å—Ç–∏–≥–∞–ª–∏ –≤ –ø–µ—Ä–∏–æ–¥ –Ω–∞–∏–±–æ–ª—å—à–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏?",
        options: [
          {value: 1, label: "–ú–µ–Ω–µ–µ 25%", description: "–ù–∏–∑–∫–∞—è –æ—Ä–≥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å"}, 
          {value: 3, label: "25-50%", description: "–£–º–µ—Ä–µ–Ω–Ω–∞—è –æ—Ä–≥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å"}, 
          {value: 4, label: "50-75%", description: "–•–æ—Ä–æ—à–∞—è –æ—Ä–≥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å"}, 
          {value: 5, label: "75-90%", description: "–í—ã—Å–æ–∫–∞—è –æ—Ä–≥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å"}, 
          {value: 6, label: "90-100%", description: "–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è –æ—Ä–≥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å"}, 
          {value: 8, label: "100%", description: "–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –æ—Ä–≥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å"}
        ]
      }
    ]
  },
  nagoski_questions_universal: {
    sis: [
      "–ü–æ–∫–∞ –≤—Å–µ –Ω–µ –±—É–¥–µ—Ç ¬´–∫–∞–∫ –Ω–∞–¥–æ¬ª, –º–Ω–µ —Å–ª–æ–∂–Ω–æ –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–µ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ",
      "–ö–æ–≥–¥–∞ —è –≤–æ–∑–±—É–∂–¥–∞—é—Å—å, –ª—é–±–∞—è –º–µ–ª–æ—á—å —Å–ø–æ—Å–æ–±–Ω–∞ —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å —ç—Ç–æ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ", 
      "–ú–Ω–µ –∫—Ä–∞–π–Ω–µ –≤–∞–∂–Ω–æ –¥–æ–≤–µ—Ä—è—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä—É, —á—Ç–æ–±—ã –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –≤–æ–∑–±—É–¥–∏—Ç—å—Å—è",
      "–ï—Å–ª–∏ —è –ø–µ—Ä–µ–∂–∏–≤–∞—é, —á—Ç–æ –Ω–µ —Å–º–æ–≥—É –±—ã—Å—Ç—Ä–æ –≤–æ–∑–±—É–¥–∏—Ç—å—Å—è –∏–ª–∏ –¥–æ—Å—Ç–∏—á—å –æ—Ä–≥–∞–∑–º–∞, —ç—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ",
      "–°—Ç–µ—Å–Ω–µ–Ω–∏–µ –∏ –∏–∑–ª–∏—à–Ω–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è —Å–µ–∫—Å–∞ –º–µ—à–∞—é—Ç –º–Ω–µ"
    ],
    ses: [
      "–Ø –º–æ–≥—É –≤–æ–∑–±—É–∂–¥–∞—Ç—å—Å—è –æ—Ç –æ–¥–Ω–æ–≥–æ —Ç–æ–ª—å–∫–æ –∞—Ä–æ–º–∞—Ç–∞ —á–µ–ª–æ–≤–µ–∫–∞",
      "–ö–æ–≥–¥–∞ –ø–∞—Ä—Ç–Ω–µ—Ä –ø—Ä–æ—è–≤–ª—è–µ—Ç —Ç–∞–ª–∞–Ω—Ç –∏–ª–∏ —É–º, —ç—Ç–æ –º–µ–Ω—è –≤–æ–∑–±—É–∂–¥–∞–µ—Ç",
      "–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–µ–∫—Å–∞ –≤ –Ω–µ–æ–±—ã—á–Ω–æ–º –º–µ—Å—Ç–µ –º–µ–Ω—è –≤–æ–∑–±—É–∂–¥–∞–µ—Ç", 
      "–§–∞–Ω—Ç–∞–∑–∏–∏ –∏–ª–∏ –º—ã—Å–ª–∏ –æ —Å–µ–∫—Å–µ –ª–µ–≥–∫–æ –≤—ã–∑—ã–≤–∞—é—Ç —É –º–µ–Ω—è –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ",
      "–ì–æ—Ä–º–æ–Ω–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É—Å–∏–ª–∏–≤–∞—é—Ç –º–æ—é –≤–æ–∑–±—É–¥–∏–º–æ—Å—Ç—å",
      "–Ø —Å–∏–ª—å–Ω–æ –≤–æ–∑–±—É–∂–¥–∞—é—Å—å, –∫–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ —è–≤–Ω–æ —Ö–æ—á–µ—Ç –º–µ–Ω—è"
    ]
  },
  constitution_types: {
    "1.0-1.5": {type: "–ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ —Å–ª–∞–±–∞—è", description: "–û—á–µ–Ω—å –ø–æ–∑–¥–Ω–µ–µ —Å–æ–∑—Ä–µ–≤–∞–Ω–∏–µ, –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–æ–ª–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", color: "#ff6b6b"},
    "1.6-2.5": {type: "–û—á–µ–Ω—å —Å–ª–∞–±–∞—è", description: "–ü–æ–∑–¥–Ω–µ–µ —Å–æ–∑—Ä–µ–≤–∞–Ω–∏–µ, –Ω–∏–∑–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", color: "#ff8a80"}, 
    "2.6-3.5": {type: "–°–ª–∞–±–∞—è", description: "–ü–æ–∑–¥–Ω–µ–µ —Å–æ–∑—Ä–µ–≤–∞–Ω–∏–µ, —Ä–µ–¥–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", color: "#ffb74d"},
    "3.6-4.5": {type: "–û—Å–ª–∞–±–ª–µ–Ω–Ω–∞—è —Å—Ä–µ–¥–Ω—è—è", description: "–£–º–µ—Ä–µ–Ω–Ω–æ –ø–æ–∑–¥–Ω–µ–µ —Å–æ–∑—Ä–µ–≤–∞–Ω–∏–µ", color: "#fff176"},
    "4.6-5.5": {type: "–°—Ä–µ–¥–Ω—è—è", description: "–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ, —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", color: "#aed581"},
    "5.6-6.5": {type: "–£—Å–∏–ª–µ–Ω–Ω–∞—è —Å—Ä–µ–¥–Ω—è—è", description: "–£–º–µ—Ä–µ–Ω–Ω–æ —Ä–∞–Ω–Ω–µ–µ —Å–æ–∑—Ä–µ–≤–∞–Ω–∏–µ", color: "#81c784"},
    "6.6-7.5": {type: "–°–∏–ª—å–Ω–∞—è", description: "–†–∞–Ω–Ω–µ–µ —Å–æ–∑—Ä–µ–≤–∞–Ω–∏–µ, –≤—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", color: "#66bb6a"},
    "7.6-8.5": {type: "–û—á–µ–Ω—å —Å–∏–ª—å–Ω–∞—è", description: "–û—á–µ–Ω—å —Ä–∞–Ω–Ω–µ–µ —Å–æ–∑—Ä–µ–≤–∞–Ω–∏–µ, –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", color: "#4caf50"},
    "8.6-9.0": {type: "–ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ —Å–∏–ª—å–Ω–∞—è", description: "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ä–∞–Ω–Ω–µ–µ —Å–æ–∑—Ä–µ–≤–∞–Ω–∏–µ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", color: "#2e7d32"}
  }
};

// –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
let currentTest = null;
let currentGender = null;
let currentQuestion = 0;
let testAnswers = {};
let nagoskiAnswers = {};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
document.addEventListener('DOMContentLoaded', function() {
  console.log('App initializing...');
  initializeApp();
});

function initializeApp() {
  setupNavigation();
  setupTestCards();
  setupGenderSelection();
  setupModalCalculator();
  setupTestNavigation();
  setupNagoskiTest();
  setupGuideCalculators();
  setupContactInfo();

  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –∏–Ω–¥–µ–∫—Å–∞ —Å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  setTimeout(() => {
    calculateGuideIndex();
    calculateModalIndex();
  }, 100);

  console.log('App initialized successfully');
}

// –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
function setupNavigation() {
  console.log('Setting up navigation...');
  
  // –ï–¥–∏–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  document.addEventListener('click', function(e) {
    console.log('Click detected:', e.target);
    
    // –ö–Ω–æ–ø–∫–∏ –Ω–∞–∑–∞–¥
    if (e.target.classList.contains('back-btn')) {
      e.preventDefault();
      console.log('Back button clicked');
      const target = e.target.getAttribute('data-target');
      console.log('Target section:', target);
      if (target) {
        showSection(target);
      }
      return;
    }
    
    // –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é
    if (e.target.classList.contains('nav-link')) {
      e.preventDefault();
      console.log('Nav link clicked');
      const section = e.target.getAttribute('data-section');
      console.log('Target section:', section);
      if (section) {
        showSection(section);
      }
      return;
    }
    
    // –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç–µ—Å—Ç–æ–≤
    const testCard = e.target.closest('.test-card');
    if (testCard) {
      e.preventDefault();
      console.log('Test card clicked');
      const testType = testCard.getAttribute('data-test');
      console.log('Test type:', testType);
      currentTest = testType;
      
      if (testType === 'vasilchenko') {
        showSection('vasilchenko-info');
      } else if (testType === 'nagoski') {
        showSection('nagoski-info');
      }
      return;
    }
    
    // –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –ø–æ–ª–∞
    if (e.target.classList.contains('gender-btn')) {
      e.preventDefault();
      console.log('Gender button clicked');
      const gender = e.target.getAttribute('data-gender');
      console.log('Selected gender:', gender);
      currentGender = gender;
      
      if (gender === 'male') {
        startVasilchenkoTest('male');
      } else if (gender === 'female') {
        startVasilchenkoTest('female');
      }
      return;
    }
    
    // –ö–Ω–æ–ø–∫–∞ –Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–∞ –ù–∞–≥–æ—Å–∫–∏
    if (e.target.classList.contains('start-nagoski')) {
      e.preventDefault();
      console.log('Start Nagoski clicked');
      startNagoskiTest();
      return;
    }
    
    // –î—Ä—É–≥–∏–µ –∫–Ω–æ–ø–∫–∏ —Å data-target
    if (e.target.hasAttribute('data-target') && !e.target.classList.contains('back-btn')) {
      e.preventDefault();
      const target = e.target.getAttribute('data-target');
      if (target) {
        showSection(target);
      }
      return;
    }
    
    // –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
    handleTestNavigation(e);
    
    // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    handleModal(e);
    
    // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
    handleResults(e);
  });
}

function showSection(sectionId) {
    console.log('Showing section:', sectionId);

    // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏
    document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
    });

    // –ü–æ–∫–∞–∑–∞—Ç—å —Ü–µ–ª–µ–≤—É—é —Å–µ–∫—Ü–∏—é
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.classList.add('active');
        console.log('Section shown successfully:', sectionId);

        // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∞–Ω–∏–º–∞—Ü–∏–π
        setTimeout(() => {
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
            window.scrollTo({
                top: 0,
                left: 0,
                behavior: 'smooth'
            });
        }, 50);
    } else {
        console.error('Section not found:', sectionId);
    }
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
function handleTestNavigation(e) {
  const target = e.target;
  
  // –ü—Ä–µ–¥—ã–¥—É—â–∏–π –≤–æ–ø—Ä–æ—Å
  if (target.id === 'prev-question' || target.id === 'prev-question-f' || target.id === 'prev-question-n') {
    e.preventDefault();
    console.log('Previous question clicked');
    if (currentQuestion > 0) {
      currentQuestion--;
      
      if (target.id === 'prev-question-n') {
        renderNagoskiQuestion();
      } else {
        const gender = target.id === 'prev-question' ? 'male' : 'female';
        const vectors = appData[`vasilchenko_${gender}_full`].vectors;
        renderVasilchenkoQuestion(vectors, gender);
      }
    }
    return;
  }
  
  // –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
  if (target.id === 'next-question' || target.id === 'next-question-f' || target.id === 'next-question-n') {
    e.preventDefault();
    console.log('Next question clicked');
    
    if (target.id === 'next-question-n') {
      saveCurrentNagoskiAnswer();
      const totalQuestions = appData.nagoski_questions_universal.sis.length + appData.nagoski_questions_universal.ses.length;
      if (currentQuestion < totalQuestions - 1) {
        currentQuestion++;
        renderNagoskiQuestion();
      }
    } else {
      const gender = target.id === 'next-question' ? 'male' : 'female';
      if (saveCurrentAnswer(gender)) {
        const vectors = appData[`vasilchenko_${gender}_full`].vectors;
        if (currentQuestion < vectors.length - 1) {
          currentQuestion++;
          renderVasilchenkoQuestion(vectors, gender);
        }
      }
    }
    return;
  }
  
  // –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç
  if (target.id === 'finish-test' || target.id === 'finish-test-f' || target.id === 'finish-test-n') {
    e.preventDefault();
    console.log('Finish test clicked');
    
    if (target.id === 'finish-test-n') {
      saveCurrentNagoskiAnswer();
      finishNagoskiTest();
    } else {
      const gender = target.id === 'finish-test' ? 'male' : 'female';
      if (saveCurrentAnswer(gender)) {
        finishVasilchenkoTest(gender);
      }
    }
    return;
  }
  
  // –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ç—Ä–æ—Ö–∞–Ω—Ç–µ—Ä–∞
  if (target.hasAttribute('data-action') && target.getAttribute('data-action') === 'open-calculator') {
    e.preventDefault();
    console.log('Calculator button clicked');
    openTrochanterCalculator();
    return;
  }
  
  // –û–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–æ—Ö–∞–Ω—Ç–µ—Ä–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞
  if (target.hasAttribute('data-action') && target.getAttribute('data-action') === 'open-description') {
    e.preventDefault();
    console.log('Description button clicked');
    openTrochanterDescription();
    return;
  }
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function handleModal(e) {
  const calculatorModal = document.getElementById('trochanter-modal');
  const descriptionModal = document.getElementById('trochanter-description-modal');

  // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
  if (e.target.classList.contains('modal-close')) {
    console.log('Modal close clicked');
    if (calculatorModal) calculatorModal.classList.add('hidden');
    if (descriptionModal) descriptionModal.classList.add('hidden');
    return;
  }
  
  // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Ñ–æ–Ω –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
  if ((e.target === calculatorModal && calculatorModal && calculatorModal.classList.contains('modal')) ||
      (e.target === descriptionModal && descriptionModal && descriptionModal.classList.contains('modal'))) {
    console.log('Modal background clicked');
    if (e.target === calculatorModal) calculatorModal.classList.add('hidden');
    if (e.target === descriptionModal) descriptionModal.classList.add('hidden');
    return;
  }



  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
  if (e.target.id === 'use-trochanter') {
    console.log('Use trochanter clicked');
    e.preventDefault();
    e.stopPropagation();
    
    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –ª–∏ –∫–Ω–æ–ø–∫–∞
    if (e.target.disabled) {
      console.log('Button is disabled, ignoring click');
      return;
    }
    
    const resultSpan = document.getElementById('trochanter-result');
    const index = parseFloat(resultSpan.textContent);
    console.log('Index value:', index);
    
    if (index && !isNaN(index)) {
      const trochanterInput = document.getElementById('answer-trochanter_index');
      if (trochanterInput) {
        trochanterInput.value = index;
        testAnswers['trochanter_index'] = index;
        console.log('Value applied to input:', index);
      }
      
      // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
      const calculatorModal = document.getElementById('trochanter-modal');
      console.log('Calculator modal element:', calculatorModal);
      if (calculatorModal) {
        calculatorModal.classList.add('hidden');
        console.log('Modal closed');
      } else {
        console.error('Calculator modal not found!');
      }
      
      // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è
      console.log('Trochanter index value applied:', index);
    } else {
      console.error('Invalid index value:', index);
    }
    return;
  }
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
function handleResults(e) {
  const target = e.target;
  
  if (target.id === 'share-results') {
    e.preventDefault();
    const text = generateResultsText('vasilchenko');
    if (navigator.share) {
      navigator.share({text});
    } else {
      copyToClipboard(text);
    }
    return;
  }
  
  if (target.id === 'share-nagoski-results') {
    e.preventDefault();
    const text = generateResultsText('nagoski');
    if (navigator.share) {
      navigator.share({text});
    } else {
      copyToClipboard(text);
    }
    return;
  }
  
  if (target.classList.contains('restart-test')) {
    e.preventDefault();
    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç –∑–∞–Ω–æ–≤–æ? –í—Å–µ –æ—Ç–≤–µ—Ç—ã –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) {
      testAnswers = {};
      currentQuestion = 0;
      if (currentGender === 'male') {
        startVasilchenkoTest('male');
      } else if (currentGender === 'female') {
        startVasilchenkoTest('female');
      }
    }
    return;
  }
  
  if (target.classList.contains('restart-nagoski')) {
    e.preventDefault();
    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç –∑–∞–Ω–æ–≤–æ? –í—Å–µ –æ—Ç–≤–µ—Ç—ã –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) {
      nagoskiAnswers = {};
      currentQuestion = 0;
      startNagoskiTest();
    }
    return;
  }
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ —Ç–µ—Å—Ç–æ–≤ (—É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ setupNavigation)
function setupTestCards() {
  console.log('Test cards setup completed (handled by main navigation)');
}

// –í—ã–±–æ—Ä –ø–æ–ª–∞ (—É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ setupNavigation)
function setupGenderSelection() {
  console.log('Gender selection setup completed (handled by main navigation)');
}

// –ù–∞—á–∞–ª–æ —Ç–µ—Å—Ç–∞ –í–∞—Å–∏–ª—å—á–µ–Ω–∫–æ
function startVasilchenkoTest(gender) {
  console.log('Starting Vasilchenko test for:', gender);
  currentQuestion = 0;
  testAnswers = {};
  
  const sectionId = `vasilchenko-${gender}`;
  showSection(sectionId);
  
  const vectors = appData[`vasilchenko_${gender}_full`].vectors;
  renderVasilchenkoQuestion(vectors, gender);
}

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ –í–∞—Å–∏–ª—å—á–µ–Ω–∫–æ
function renderVasilchenkoQuestion(vectors, gender) {
  console.log('Rendering Vasilchenko question:', currentQuestion, 'for gender:', gender);
  const container = document.getElementById(`${gender}-questions`);
  if (!container) {
    console.error('Question container not found for gender:', gender);
    return;
  }
  
  const vector = vectors[currentQuestion];
  console.log('Current vector:', vector);
  
  container.innerHTML = '';

  const questionDiv = document.createElement('div');
  questionDiv.className = 'question current';
  
  let questionHTML = `
    <h3>${vector.label}</h3>
    <div class="question-explanation">
      <h4>üí° –ü–æ—è—Å–Ω–µ–Ω–∏–µ:</h4>
      <p>${vector.explanation}</p>
    </div>
  `;

  if (vector.type === 'number') {
    if (vector.name === 'trochanter_index') {
      questionHTML += `
        <div class="number-input-group">
          <input type="number" step="0.01" class="form-control" id="answer-${vector.name}" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1.95">
          <button class="btn btn--outline trochanter-calculator-btn" data-action="open-calculator">
            üìè –û—Ç–∫—Ä—ã—Ç—å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
          </button>
        </div>
        <div class="info-highlight">
          <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong> –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—Ç–µ —Å–≤–æ–π —Ç—Ä–æ—Ö–∞–Ω—Ç–µ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å <a href="#" data-action="open-calculator" style="color: var(--color-primary); text-decoration: underline;">–æ–Ω–ª–∞–π–Ω-–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–º</a> –∏–ª–∏ –∏–∑—É—á–∏—Ç–µ <a href="#" data-action="open-description" style="color: var(--color-primary); text-decoration: underline;">–∫–∞–∫ –∏–∑–º–µ—Ä–∏—Ç—å —Ç—Ä–æ—Ö–∞–Ω—Ç–µ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å</a>
        </div>
      `;
    } else {
      questionHTML += `
        <div class="number-input-group">
          <input type="number" class="form-control" id="answer-${vector.name}" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç">
          <span class="input-helper">–ª–µ—Ç</span>
        </div>
      `;
    }
  } else if (vector.type === 'radio') {
    questionHTML += '<div class="radio-group">';
    vector.options.forEach(option => {
      questionHTML += `
        <label class="radio-option">
          <input type="radio" name="answer-${vector.name}" value="${option.value}">
          <div class="radio-option-content">
            <div class="radio-option-label">${option.label}</div>
            ${option.description ? `<div class="radio-option-description">${option.description}</div>` : ''}
          </div>
        </label>
      `;
    });
    questionHTML += '</div>';
  }

  questionDiv.innerHTML = questionHTML;
  container.appendChild(questionDiv);

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä–∞–¥–∏–æ –∫–Ω–æ–ø–æ–∫
  if (vector.type === 'radio') {
    questionDiv.querySelectorAll('input[type="radio"]').forEach(radio => {
      radio.addEventListener('change', (e) => {
        questionDiv.querySelectorAll('.radio-option').forEach(opt => {
          opt.classList.remove('selected');
        });
        e.target.closest('.radio-option').classList.add('selected');
        testAnswers[vector.name] = parseInt(e.target.value);
        console.log('Radio answer saved:', vector.name, testAnswers[vector.name]);
      });
    });
  }

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø–æ–ª–µ–π
  if (vector.type === 'number') {
    const input = document.getElementById(`answer-${vector.name}`);
    if (input) {
      input.addEventListener('input', (e) => {
        const value = parseFloat(e.target.value);
        if (!isNaN(value) && value > 0) {
          testAnswers[vector.name] = value;
          e.target.classList.remove('error');
          console.log('Number answer saved:', vector.name, testAnswers[vector.name]);
        }
      });
    }
  }

  // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
  if (testAnswers[vector.name] !== undefined) {
    if (vector.type === 'number') {
      const input = document.getElementById(`answer-${vector.name}`);
      if (input) input.value = testAnswers[vector.name];
    } else if (vector.type === 'radio') {
      const radio = questionDiv.querySelector(`input[value="${testAnswers[vector.name]}"]`);
      if (radio) {
        radio.checked = true;
        radio.closest('.radio-option').classList.add('selected');
      }
    }
  }

  updateProgress(currentQuestion + 1, vectors.length, gender);
  updateNavButtons(vectors.length, gender);
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —Ç–µ—Å—Ç–∞ (—É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ setupNavigation)
function setupTestNavigation() {
  console.log('Test navigation setup completed (handled by main navigation)');
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞
function saveCurrentAnswer(gender) {
  console.log('Saving current answer for gender:', gender);
  const vectors = appData[`vasilchenko_${gender}_full`].vectors;
  const vector = vectors[currentQuestion];
  
  if (vector.type === 'number') {
    const input = document.getElementById(`answer-${vector.name}`);
    if (!input) return false;
    
    const value = parseFloat(input.value);
    
    if (!value || value <= 0) {
      showValidationError(input, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ');
      return false;
    }
    
    testAnswers[vector.name] = value;
  } else if (vector.type === 'radio') {
    if (testAnswers[vector.name] === undefined) {
      const radioGroup = document.querySelector(`input[name="answer-${vector.name}"]`);
      if (radioGroup) {
        showValidationError(radioGroup.closest('.radio-group'), '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤');
      }
      return false;
    }
  }
  
  clearValidationErrors();
  console.log('Answer saved successfully');
  return true;
}

function showValidationError(element, message) {
  clearValidationErrors();
  element.classList.add('error');
  
  const errorDiv = document.createElement('div');
  errorDiv.className = 'error-message show';
  errorDiv.textContent = message;
  
  element.parentNode.appendChild(errorDiv);
  element.focus();
}

function clearValidationErrors() {
  document.querySelectorAll('.error').forEach(el => el.classList.remove('error'));
  document.querySelectorAll('.error-message').forEach(el => el.remove());
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
function updateNavButtons(totalQuestions, gender) {
  const suffix = gender === 'male' ? '' : '-f';
  const prevBtn = document.getElementById(`prev-question${suffix}`);
  const nextBtn = document.getElementById(`next-question${suffix}`);
  const finishBtn = document.getElementById(`finish-test${suffix}`);
  
  if (prevBtn) prevBtn.disabled = currentQuestion === 0;
  
  if (currentQuestion === totalQuestions - 1) {
    if (nextBtn) nextBtn.classList.add('hidden');
    if (finishBtn) finishBtn.classList.remove('hidden');
  } else {
    if (nextBtn) nextBtn.classList.remove('hidden');
    if (finishBtn) finishBtn.classList.add('hidden');
  }
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
function updateProgress(current, total, context) {
  let progressBar;
  
  if (context === 'male' || context === 'female') {
    progressBar = document.querySelector(`#vasilchenko-${context} .progress-fill`);
  } else if (context === 'nagoski') {
    progressBar = document.querySelector('#nagoski-test .progress-fill');
  }
  
  if (progressBar) {
    const percentage = (current / total) * 100;
    progressBar.style.width = `${percentage}%`;
  }
}

// –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ç—Ä–æ—Ö–∞–Ω—Ç–µ—Ä–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞
function setupModalCalculator() {
  console.log('Modal calculator setup completed (handled by main navigation)');
  
  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –ø—Ä–∏ –≤–≤–æ–¥–µ
  document.addEventListener('input', function(e) {
    if (e.target.id === 'height-input' || e.target.id === 'leg-length-input') {
      calculateModalIndex();
    }
  });
  
  // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ"
  document.addEventListener('click', function(e) {
    if (e.target.id === 'use-trochanter') {
      console.log('Use trochanter button clicked directly');
      e.preventDefault();
      e.stopPropagation();
      
      const resultSpan = document.getElementById('trochanter-result');
      const index = parseFloat(resultSpan.textContent);
      console.log('Direct handler - Index value:', index);
      
      if (index && !isNaN(index)) {
        const trochanterInput = document.getElementById('answer-trochanter_index');
        if (trochanterInput) {
          trochanterInput.value = index;
          testAnswers['trochanter_index'] = index;
          console.log('Direct handler - Value applied to input:', index);
        }
        
        // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
        const calculatorModal = document.getElementById('trochanter-modal');
        if (calculatorModal) {
          calculatorModal.classList.add('hidden');
          console.log('Direct handler - Modal closed');
        }
      }
    }
  });
}

function calculateModalIndex() {
  const heightInput = document.getElementById('height-input');
  const legLengthInput = document.getElementById('leg-length-input');
  const resultSpan = document.getElementById('trochanter-result');
  const useBtn = document.getElementById('use-trochanter');
  const modalInterpretationResult = document.getElementById('modal-interpretation-result');
  
  if (!heightInput || !legLengthInput || !resultSpan || !useBtn) return;
  
  const height = parseFloat(heightInput.value);
  const legLength = parseFloat(legLengthInput.value);
  
  if (height && legLength && legLength > 0) {
    const index = (height / legLength).toFixed(2);
    resultSpan.textContent = index;
    useBtn.disabled = false;
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
    if (modalInterpretationResult) {
      const interpretation = getIndexInterpretation(parseFloat(index));
      modalInterpretationResult.innerHTML = interpretation;
      modalInterpretationResult.classList.add('visible');
    }
  } else {
    resultSpan.textContent = '‚Äî';
    useBtn.disabled = true;
    
    if (modalInterpretationResult) {
      modalInterpretationResult.classList.remove('visible');
    }
  }
}

function openTrochanterCalculator() {
  console.log('Opening trochanter calculator');
  const modal = document.getElementById('trochanter-modal');
  if (modal) {
    modal.classList.remove('hidden');
    // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    const heightInput = document.getElementById('height-input');
    const legLengthInput = document.getElementById('leg-length-input');
    
    if (heightInput) heightInput.value = '175';
    if (legLengthInput) legLengthInput.value = '90';
    
    // –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏ –ø–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    setTimeout(() => {
      calculateModalIndex();
    }, 100);
  }
}

function openTrochanterDescription() {
  console.log('Opening trochanter description');
  const modal = document.getElementById('trochanter-description-modal');
  if (modal) {
    modal.classList.remove('hidden');
  }
}

// –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã –≤ —Å–ø—Ä–∞–≤–æ—á–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö
function setupGuideCalculators() {
  document.addEventListener('input', function(e) {
    if (e.target.id === 'height-calc' || e.target.id === 'leg-calc') {
      calculateGuideIndex();
    }
  });
}

function calculateGuideIndex() {
  const heightCalc = document.getElementById('height-calc');
  const legCalc = document.getElementById('leg-calc');
  const calcResult = document.getElementById('calc-result');
  const interpretationResult = document.getElementById('interpretation-result');
  
  if (!heightCalc || !legCalc || !calcResult || !interpretationResult) return;
  
  const height = parseFloat(heightCalc.value || 0);
  const legLength = parseFloat(legCalc.value || 0);
  
  if (height && legLength && legLength > 0) {
    const index = (height / legLength).toFixed(2);
    calcResult.textContent = index;
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    const interpretation = getIndexInterpretation(parseFloat(index));
    interpretationResult.innerHTML = interpretation;
    interpretationResult.classList.add('visible');
  } else {
    calcResult.textContent = '‚Äî';
    interpretationResult.classList.remove('visible');
  }
}

function getIndexInterpretation(index) {
  let maleInterpretation = '';
  let femaleInterpretation = '';
  
  // –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –¥–ª—è –º—É–∂—á–∏–Ω
  if (index <= 1.99) {
    maleInterpretation = '—Å–∏–ª—å–Ω–∞—è';
  } else if (index >= 2.00 && index <= 2.02) {
    maleInterpretation = '—Å—Ä–µ–¥–Ω—è—è';
  } else if (index >= 2.03) {
    maleInterpretation = '—Å–ª–∞–±–∞—è';
  } else {
    maleInterpretation = '–Ω–µ—Ç–∏–ø–∏—á–Ω–∞—è';
  }
  
  // –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –¥–ª—è –∂–µ–Ω—â–∏–Ω
  if (index >= 1.88 && index <= 1.96) {
    femaleInterpretation = '—Å–ª–∞–±–∞—è';
  } else if (index >= 1.97 && index <= 2.00) {
    femaleInterpretation = '—Å—Ä–µ–¥–Ω—è—è';
  } else if (index >= 2.01 && index <= 2.05) {
    femaleInterpretation = '—Å–∏–ª—å–Ω–∞—è';
  } else if (index > 2.05) {
    femaleInterpretation = '–Ω–µ—Ç–∏–ø–∏—á–Ω–∞—è (–æ—á–µ–Ω—å —Å–∏–ª—å–Ω–∞—è)';
  } else {
    femaleInterpretation = '–Ω–µ—Ç–∏–ø–∏—á–Ω–∞—è (–æ—á–µ–Ω—å —Å–ª–∞–±–∞—è)';
  }
  
  return `<strong>–¢—Ä–æ—Ö–∞–Ω—Ç–µ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å: ${index}</strong><br>
          ‚Ä¢ –î–ª—è –º—É–∂—á–∏–Ω: <strong>${maleInterpretation} –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏—è</strong><br>
          ‚Ä¢ –î–ª—è –∂–µ–Ω—â–∏–Ω: <strong>${femaleInterpretation} –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏—è</strong>`;
}

// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ –í–∞—Å–∏–ª—å—á–µ–Ω–∫–æ
function finishVasilchenkoTest(gender) {
  console.log('Finishing Vasilchenko test for gender:', gender);
  const vectors = appData[`vasilchenko_${gender}_full`].vectors;
  let totalScore = 0;
  let validAnswers = 0;
  
  vectors.forEach(vector => {
    const answer = testAnswers[vector.name];
    if (answer !== undefined && answer !== 0) {
      let score = 0;
      
      if (vector.type === 'number') {
        score = calculateNumberScore(answer, vector.scoring);
      } else if (vector.type === 'radio') {
        score = answer;
      }
      
      totalScore += score;
      validAnswers++;
    }
  });
  
  const averageScore = validAnswers > 0 ? (totalScore / validAnswers).toFixed(1) : 0;
  console.log('Final score:', averageScore);
  showVasilchenkoResults(averageScore);
}

// –†–∞—Å—á–µ—Ç –±–∞–ª–ª–æ–≤ –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
function calculateNumberScore(answer, scoring) {
  for (const [range, score] of Object.entries(scoring)) {
    if (range.includes('+')) {
      const minValue = parseInt(range.replace('+', ''));
      if (answer >= minValue) return score;
    } else if (range.includes('-')) {
      if (range.endsWith('-')) {
        const maxValue = parseInt(range.replace('-', ''));
        if (answer <= maxValue) return score;
      } else {
        const [min, max] = range.split('-').map(Number);
        if (answer >= min && answer <= max) return score;
      }
    } else {
      const exactValue = parseFloat(range);
      if (Math.abs(answer - exactValue) < 0.005) return score;
    }
  }
  return 1;
}

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –í–∞—Å–∏–ª—å—á–µ–Ω–∫–æ
function showVasilchenkoResults(score) {
  console.log('Showing Vasilchenko results with score:', score);
  showSection('vasilchenko-results');
  
  const totalScoreElement = document.getElementById('total-score');
  if (totalScoreElement) totalScoreElement.textContent = score;
  
  const constitutionInfo = getConstitutionType(score);
  
  const typeElement = document.getElementById('constitution-type');
  if (typeElement) {
    typeElement.textContent = constitutionInfo.type;
    typeElement.style.color = constitutionInfo.color;
  }
  
  const marker = document.querySelector('.score-marker');
  if (marker) {
    const position = ((parseFloat(score) - 1) / 8) * 100;
    marker.style.left = `${Math.max(0, Math.min(100, position))}%`;
  }
  
  const description = document.getElementById('result-description');
  if (description) {
    description.innerHTML = `
      <h4>–í–∞—à —Ç–∏–ø –ø–æ–ª–æ–≤–æ–π –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏: ${constitutionInfo.type}</h4>
      <p><strong>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞:</strong> ${constitutionInfo.description}</p>
      <p><strong>–ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:</strong></p>
      <ul>
        <li>–í–∞—à–∞ –ø–æ–ª–æ–≤–∞—è –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏</li>
        <li>–ö–∞–∂–¥—ã–π —Ç–∏–ø –∏–º–µ–µ—Ç —Å–≤–æ–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</li>
        <li>–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–≤–æ–µ–≥–æ —Ç–∏–ø–∞ –ø–æ–º–æ–≥–∞–µ—Ç –ª—É—á—à–µ —É–∑–Ω–∞—Ç—å —Å–µ–±—è</li>
        <li>–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –∑–∞–≤–∏—Å–∏—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç —Ç–∏–ø–∞ –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏</li>
      </ul>
      <p><strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong></p>
      <ul>
        <li>–ü—Ä–∏–Ω–∏–º–∞–π—Ç–µ —Å–≤–æ—é –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ—Å—Ç—å - –≤—Å–µ —Ç–∏–ø—ã –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏ –Ω–æ—Ä–º–∞–ª—å–Ω—ã</li>
        <li>–£—á–∏—Ç—ã–≤–∞–π—Ç–µ —Å–≤–æ–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π</li>
        <li>–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É</li>
        <li>–ü–æ–º–Ω–∏—Ç–µ: –≥–∞—Ä–º–æ–Ω–∏—è –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ–º</li>
      </ul>
    `;
  }
}

function getConstitutionType(score) {
  const numScore = parseFloat(score);
  
  for (const [range, info] of Object.entries(appData.constitution_types)) {
    const [min, max] = range.split('-').map(Number);
    if (numScore >= min && numScore <= max) {
      return info;
    }
  }
  
  if (numScore < 1.6) return appData.constitution_types['1.0-1.5'];
  if (numScore > 8.5) return appData.constitution_types['8.6-9.0'];
  
  return appData.constitution_types['4.6-5.5'];
}

// –¢–µ—Å—Ç –ù–∞–≥–æ—Å–∫–∏ (—É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ setupNavigation)
function setupNagoskiTest() {
  console.log('Nagoski test setup completed (handled by main navigation)');
}

function startNagoskiTest() {
  console.log('Starting Nagoski test');
  currentQuestion = 0;
  nagoskiAnswers = {};
  showSection('nagoski-test');
  renderNagoskiQuestion();
}

function renderNagoskiQuestion() {
  console.log('Rendering Nagoski question:', currentQuestion);
  const container = document.getElementById('nagoski-questions');
  if (!container) {
    console.error('Nagoski question container not found');
    return;
  }
  
  const allQuestions = [...appData.nagoski_questions_universal.sis, ...appData.nagoski_questions_universal.ses];
  const totalQuestions = allQuestions.length;
  
  const questionText = allQuestions[currentQuestion];
  const questionType = currentQuestion < appData.nagoski_questions_universal.sis.length ? 'sis' : 'ses';
  
  container.innerHTML = '';

  const questionDiv = document.createElement('div');
  questionDiv.className = 'question current';
  
  const typeLabel = questionType === 'sis' ? 'üõë –°–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–º–æ–∂–µ–Ω–∏—è (SIS)' : 'üöÄ –°–∏—Å—Ç–µ–º–∞ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è (SES)';
  const typeColor = questionType === 'sis' ? 'var(--color-error)' : 'var(--color-success)';
  
  questionDiv.innerHTML = `
    <div class="question-type" style="color: ${typeColor}; margin-bottom: 16px; font-weight: 500;">
      ${typeLabel}
    </div>
    <h3>${questionText}</h3>
    <div class="question-explanation">
      <h4>üí° –ö–∞–∫ –æ—Ç–≤–µ—á–∞—Ç—å:</h4>
      <p>–û—Ü–µ–Ω–∏—Ç–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∏–º–µ–Ω–Ω–æ –≤–∞—Å. –ù–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ - –≤–∞–∂–Ω–∞ –≤–∞—à–∞ —á–µ—Å—Ç–Ω–∞—è —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∞.</p>
    </div>
    <div class="scale-group">
      <div class="scale-labels">
        <span>–°–æ–≤—Å–µ–º –Ω–µ –ø—Ä–æ –º–µ–Ω—è</span>
        <span>–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ –º–µ–Ω—è</span>
      </div>
      <div class="scale-container">
        <input type="range" min="0" max="4" value="2" step="1" class="scale-slider" id="nagoski-slider">
        <div class="scale-value">
          <span id="scale-value-text">2</span> –∏–∑ 4
        </div>
      </div>
    </div>
  `;

  container.appendChild(questionDiv);
  
  const slider = document.getElementById('nagoski-slider');
  const valueText = document.getElementById('scale-value-text');
  
  if (slider && valueText) {
    slider.addEventListener('input', (e) => {
      valueText.textContent = e.target.value;
    });
    
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
    if (nagoskiAnswers[currentQuestion] !== undefined) {
      slider.value = nagoskiAnswers[currentQuestion];
      valueText.textContent = nagoskiAnswers[currentQuestion];
    }
  }
  
  updateProgress(currentQuestion + 1, totalQuestions, 'nagoski');
  updateNagoskiNavButtons();
}

function saveCurrentNagoskiAnswer() {
  const slider = document.getElementById('nagoski-slider');
  if (slider) {
    nagoskiAnswers[currentQuestion] = parseInt(slider.value);
    console.log('Nagoski answer saved:', currentQuestion, nagoskiAnswers[currentQuestion]);
    return true;
  }
  return false;
}

function updateNagoskiNavButtons() {
  const totalQuestions = appData.nagoski_questions_universal.sis.length + appData.nagoski_questions_universal.ses.length;
  const prevBtn = document.getElementById('prev-question-n');
  const nextBtn = document.getElementById('next-question-n');
  const finishBtn = document.getElementById('finish-test-n');
  
  if (prevBtn) prevBtn.disabled = currentQuestion === 0;
  
  if (currentQuestion === totalQuestions - 1) {
    if (nextBtn) nextBtn.classList.add('hidden');
    if (finishBtn) finishBtn.classList.remove('hidden');
  } else {
    if (nextBtn) nextBtn.classList.remove('hidden');
    if (finishBtn) finishBtn.classList.add('hidden');
  }
}

function finishNagoskiTest() {
  console.log('Finishing Nagoski test');
  const sisQuestions = appData.nagoski_questions_universal.sis.length;
  
  let sisTotal = 0;
  let sesTotal = 0;
  
  // –†–∞—Å—á–µ—Ç SIS
  for (let i = 0; i < sisQuestions; i++) {
    sisTotal += nagoskiAnswers[i] || 0;
  }
  
  // –†–∞—Å—á–µ—Ç SES
  for (let i = sisQuestions; i < Object.keys(nagoskiAnswers).length; i++) {
    sesTotal += nagoskiAnswers[i] || 0;
  }
  
  const sisAverage = (sisTotal / sisQuestions).toFixed(1);
  const sesAverage = (sesTotal / (Object.keys(nagoskiAnswers).length - sisQuestions)).toFixed(1);
  
  console.log('Nagoski scores - SIS:', sisAverage, 'SES:', sesAverage);
  showNagoskiResults(sisAverage, sesAverage);
}

function showNagoskiResults(sisScore, sesScore) {
  console.log('Showing Nagoski results');
  showSection('nagoski-results');
  
  const sisScoreElement = document.getElementById('sis-score');
  const sesScoreElement = document.getElementById('ses-score');
  
  if (sisScoreElement) sisScoreElement.textContent = sisScore;
  if (sesScoreElement) sesScoreElement.textContent = sesScore;
  
  const sisBar = document.querySelector('.sis-fill');
  const sesBar = document.querySelector('.ses-fill');
  
  if (sisBar) sisBar.style.width = `${(sisScore / 4) * 100}%`;
  if (sesBar) sesBar.style.width = `${(sesScore / 4) * 100}%`;
  
  const temperamentInfo = getNagoskiTemperament(sisScore, sesScore);
  
  const temperamentElement = document.getElementById('temperament-type');
  if (temperamentElement) {
    temperamentElement.innerHTML = `
      <h3>${temperamentInfo.title}</h3>
      <p>${temperamentInfo.subtitle}</p>
    `;
  }
  
  const description = document.getElementById('nagoski-result-description');
  if (description) {
    description.innerHTML = `
      <h4>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≤–∞—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h4>
      <p><strong>SIS (–°–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–º–æ–∂–µ–Ω–∏—è): ${sisScore}/4</strong></p>
      <p>${getSisInterpretation(sisScore)}</p>
      <p><strong>SES (–°–∏—Å—Ç–µ–º–∞ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è): ${sesScore}/4</strong></p>
      <p>${getSesInterpretation(sesScore)}</p>
      <h4>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h4>
      <ul>
        ${temperamentInfo.recommendations.map(rec => `<li>${rec}</li>`).join('')}
      </ul>
      <p><em>–ü–æ–º–Ω–∏—Ç–µ: —ç—Ç–æ—Ç —Ç–µ—Å—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω –∏ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ª—é–¥–µ–π –ª—é–±–æ–≥–æ –ø–æ–ª–∞ –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–º–æ–≥–∞—é—Ç –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å —Å–≤–æ–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏.</em></p>
    `;
  }
}

function getNagoskiTemperament(sis, ses) {
  const sisNum = parseFloat(sis);
  const sesNum = parseFloat(ses);
  
  if (sisNum >= 2.5 && sesNum >= 2.5) {
    return {
      title: "üé¢ –°–ª–æ–∂–Ω—ã–π —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç",
      subtitle: "–í—ã—Å–æ–∫–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ —Å—Ç–∏–º—É–ª–∞–º –∏ –ø–æ–º–µ—Ö–∞–º",
      recommendations: [
        "–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∫–æ–º—Ñ–æ—Ä—Ç–Ω—É—é –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—É—é –æ–±—Å—Ç–∞–Ω–æ–≤–∫—É",
        "–£—Å—Ç—Ä–∞–Ω—è–π—Ç–µ –æ—Ç–≤–ª–µ–∫–∞—é—â–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã (—Å—Ç—Ä–µ—Å—Å, —à—É–º, –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è)",
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Ä–µ–ª–∞–∫—Å–∞—Ü–∏–∏ –∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏",
        "–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å –Ω–æ–≤—ã–º–∏ —Å—Ç–∏–º—É–ª–∞–º–∏ —Ç–æ–ª—å–∫–æ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å—Ä–µ–¥–µ",
        "–û–±—Ä–∞—â–∞–π—Ç–µ –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –±–ª–∏–∑–æ—Å—Ç—å —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º"
      ]
    };
  } else if (sisNum < 2.5 && sesNum < 2.5) {
    return {
      title: "üòå –°–ø–æ–∫–æ–π–Ω—ã–π —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç", 
      subtitle: "–ù–∏–∑–∫–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ —Å—Ç–∏–º—É–ª–∞–º –∏ –ø–æ–º–µ—Ö–∞–º",
      recommendations: [
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ —Å—Ç–∏–º—É–ª—ã –¥–ª—è –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è",
        "–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∞–º–∏",
        "–ù–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π—Ç–µ –æ –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–∞—Ö –∏ –ø–æ–º–µ—Ö–∞—Ö",
        "–§–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —É—Å–∏–ª–µ–Ω–∏–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç–∏–º—É–ª–æ–≤",
        "–£–¥–µ–ª—è–π—Ç–µ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–µ–ª—é–¥–∏–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ"
      ]
    };
  } else if (sisNum >= 2.5 && sesNum < 2.5) {
    return {
      title: "üõ°Ô∏è –û—Å—Ç–æ—Ä–æ–∂–Ω—ã–π —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç",
      subtitle: "–í—ã—Å–æ–∫–æ–µ —Ç–æ—Ä–º–æ–∂–µ–Ω–∏–µ, —É–º–µ—Ä–µ–Ω–Ω–æ–µ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ", 
      recommendations: [
        "–ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–µ—Å—Å –∏ –æ—Ç–≤–ª–µ–∫–∞—é—â–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã",
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ, –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è",
        "–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—É—é –∏ –±–µ–∑–æ–ø–∞—Å–Ω—É—é —Å—Ä–µ–¥—É",
        "–†–∞–±–æ—Ç–∞–π—Ç–µ –Ω–∞–¥ —Å–Ω–∏–∂–µ–Ω–∏–µ–º —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç–∏",
        "–£–¥–µ–ª—è–π—Ç–µ –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –¥–æ–≤–µ—Ä–∏—é –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –±–ª–∏–∑–æ—Å—Ç–∏"
      ]
    };
  } else {
    return {
      title: "üöÄ –ê–∫—Ç–∏–≤–Ω—ã–π —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç",
      subtitle: "–£–º–µ—Ä–µ–Ω–Ω–æ–µ —Ç–æ—Ä–º–æ–∂–µ–Ω–∏–µ, –≤—ã—Å–æ–∫–æ–µ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ",
      recommendations: [
        "–í—ã –ª–µ–≥–∫–æ –≤–æ–∑–±—É–∂–¥–∞–µ—Ç–µ—Å—å –æ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç–∏–º—É–ª–æ–≤",
        "–ú–æ–∂–µ—Ç–µ –±—ã—Ç—å –±–æ–ª–µ–µ —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–º–∏ –≤ –∏–Ω—Ç–∏–º–Ω–æ—Å—Ç–∏",
        "–£—á–∏—Ç—ã–≤–∞–π—Ç–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –º–µ–Ω–µ–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞",
        "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –≤ —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏",
        "–ü–æ–º–Ω–∏—Ç–µ –æ –≤–∞–∂–Ω–æ—Å—Ç–∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å–≤—è–∑–∏, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∏–º—É–ª–æ–≤"
      ]
    };
  }
}

function getSisInterpretation(score) {
  if (score >= 3) return "–í—ã—Å–æ–∫–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –æ—Ç–≤–ª–µ–∫–∞—é—â–∏–º —Ñ–∞–∫—Ç–æ—Ä–∞–º. –°—Ç—Ä–µ—Å—Å, —É—Å—Ç–∞–ª–æ—Å—Ç—å –∏–ª–∏ –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ —Å–∏–ª—å–Ω–æ –≤–ª–∏—è—é—Ç –Ω–∞ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ.";
  if (score >= 2) return "–£–º–µ—Ä–µ–Ω–Ω–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –ø–æ–º–µ—Ö–∞–º. –ò–Ω–æ–≥–¥–∞ –≤–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –º–æ–≥—É—Ç –º–µ—à–∞—Ç—å –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—é.";
  return "–ù–∏–∑–∫–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –æ—Ç–≤–ª–µ–∫–∞—é—â–∏–º —Ñ–∞–∫—Ç–æ—Ä–∞–º. –í–Ω–µ—à–Ω–∏–µ –ø–æ–º–µ—Ö–∏ —Ä–µ–¥–∫–æ –≤–ª–∏—è—é—Ç –Ω–∞ –≤–∞—à–µ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ.";
}

function getSesInterpretation(score) {
  if (score >= 3) return "–í—ã—Å–æ–∫–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –≤–æ–∑–±—É–∂–¥–∞—é—â–∏–º —Å—Ç–∏–º—É–ª–∞–º. –í—ã –ª–µ–≥–∫–æ –∏ –±—ã—Å—Ç—Ä–æ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç–µ –Ω–∞ —Å–µ–∫—Å—É–∞–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã.";
  if (score >= 2) return "–£–º–µ—Ä–µ–Ω–Ω–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ —Å—Ç–∏–º—É–ª–∞–º. –î–ª—è –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è –Ω—É–∂–Ω—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏ —Å—Ç–∏–º—É–ª—ã.";
  return "–ù–∏–∑–∫–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ —Å—Ç–∏–º—É–ª–∞–º. –î–ª—è –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –∏ –±–æ–ª–µ–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ —Å—Ç–∏–º—É–ª—ã.";
}

function generateResultsText(testType) {
    if (testType === 'vasilchenko') {
        const scoreElement = document.getElementById('total-score');
        const typeElement = document.getElementById('constitution-type');
        const score = scoreElement?.textContent || 'N/A';
        const type = typeElement?.textContent || 'N/A';
        return `–ú–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –ø–æ–ª–æ–≤–æ–π –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏ –ø–æ –í–∞—Å–∏–ª—å—á–µ–Ω–∫–æ:\n\n–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª: ${score}\n–¢–∏–ø –∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–∏: ${type}\n\n–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç: ${window.location.href}`;
    } else {
        const sisScoreElement = document.getElementById('sis-score');
        const sesScoreElement = document.getElementById('ses-score');
        const sisScore = sisScoreElement?.textContent || 'N/A';
        const sesScore = sesScoreElement?.textContent || 'N/A';
        return `–ú–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–≥–æ —Ç–µ–º–ø–µ—Ä–∞–º–µ–Ω—Ç–∞ –ø–æ –ù–∞–≥–æ—Å–∫–∏:\n\nSIS (—Ç–æ—Ä–º–æ–∂–µ–Ω–∏–µ): ${sisScore}/4\nSES (–≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ): ${sesScore}/4\n\n–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç: ${window.location.href}`;
    }
}

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —à–µ—Ä–∏–Ω–≥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
function shareToTelegram(text) {
    const url = `https://t.me/share/url?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent(text)}`;
    window.open(url, '_blank');
}

function shareToVK(text) {
    const url = `https://vk.com/share.php?url=${encodeURIComponent(window.location.href)}&title=${encodeURIComponent('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ —Å–µ–∫—Å—É–∞–ª—å–Ω–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è')}&description=${encodeURIComponent(text)}`;
    window.open(url, '_blank');
}

function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
            showNotification('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
        }).catch(() => {
            fallbackCopyToClipboard(text);
        });
    } else {
        fallbackCopyToClipboard(text);
    }
}

function fallbackCopyToClipboard(text) {
    const textArea = document.createElement('textarea');
    textArea.value = text;
    textArea.style.position = 'fixed';
    textArea.style.left = '-999999px';
    textArea.style.top = '-999999px';
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();

    try {
        document.execCommand('copy');
        showNotification('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
    } catch (err) {
        showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–¥–µ–ª–∏—Ç–µ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç –≤—Ä—É—á–Ω—É—é.');
    }

    document.body.removeChild(textArea);
}

function showNotification(message) {
    // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    const notification = document.createElement('div');
    notification.className = 'notification show';
    notification.textContent = message;
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--color-success, #4CAF50);
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        z-index: 1000;
        font-size: 14px;
        max-width: 300px;
    `;

    document.body.appendChild(notification);

    // –£–¥–∞–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —à–µ—Ä–∏–Ω–≥–∞
document.addEventListener('click', function(e) {
    if (e.target.classList.contains('share-btn') || e.target.closest('.share-btn')) {
        const button = e.target.classList.contains('share-btn') ? e.target : e.target.closest('.share-btn');
        const platform = button.getAttribute('data-platform');

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Ç–µ—Å—Ç–∞ –ø–æ —Ç–µ–∫—É—â–µ–º—É —Ä–∞–∑–¥–µ–ª—É
        let testType = 'vasilchenko';
        if (document.getElementById('nagoski-results').style.display !== 'none') {
            testType = 'nagoski';
        }

        const text = generateResultsText(testType);

        switch (platform) {
            case 'telegram':
                shareToTelegram(text);
                break;
            case 'vk':
                shareToVK(text);
                break;
            case 'copy':
                copyToClipboard(text);
                break;
        }
    }
});

function copyToClipboard(text) {
  if (navigator.clipboard) {
    navigator.clipboard.writeText(text).then(() => {
      alert('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
    }).catch(() => {
      fallbackCopyToClipboard(text);
    });
  } else {
    fallbackCopyToClipboard(text);
  }
}

function fallbackCopyToClipboard(text) {
  const textArea = document.createElement('textarea');
  textArea.value = text;
  textArea.style.position = 'fixed';
  textArea.style.left = '-999999px';
  textArea.style.top = '-999999px';
  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();
  
  try {
    document.execCommand('copy');
    alert('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
  } catch (err) {
    alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–¥–µ–ª–∏—Ç–µ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç –≤—Ä—É—á–Ω—É—é.');
  }
  
  document.body.removeChild(textArea);
}